{% extends "layout.html" %}
{% load staticfiles %}
{% load i18n %}

{% comment "License" %}
    * OSIS stands for Open Student Information System. It's an application
    * designed to manage the core business of higher education institutions,
    * such as universities, faculties, institutes and professional schools.
    * The core business involves the administration of students, teachers,
    * courses, programs and so on.
    *
    * Copyright (C) 2015-2021 Universit√© catholique de Louvain (http://www.uclouvain.be)
    *
    * This program is free software: you can redistribute it and/or modify
    * it under the terms of the GNU General Public License as published by
    * the Free Software Foundation, either version 3 of the License, or
    * (at your option) any later version.
    *
    * This program is distributed in the hope that it will be useful,
    * but WITHOUT ANY WARRANTY; without even the implied warranty of
    * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    * GNU General Public License for more details.
    *
    * A copy of this license - GNU General Public License - is available
    * at the root of the source code of this program.  If not,
    * see http://www.gnu.org/licenses/.
{% endcomment %}
{% block breadcrumb_area %}
    <ol class="breadcrumb">
        <li><a href="{% url 'dashboard_home' %}" id="lnk_home_osis"><span class="glyphicon glyphicon-home"
                                                                          aria-hidden="true"></span></a></li>
        <li class="active">{% trans 'List of students enrolled to my exams' %}</li>
    </ol>
{% endblock %}
{% block content %}
    <h1>{% trans 'List of students enrolled to my exams' %}</h1>
    {% if messages %}
        <div class="alert alert-warning">
            {% for message in messages %}
                <li>
                    {% if 'safe' in message.tags %}{{ message|safe }}{% else %}{{ message }}{% endif %}
                </li>
            {% endfor %}
        </div>
    {% endif %}
    {% if msg_error %}
        <br>
        <div class="alert alert-info">{{ msg_error }}</div>
        <br>
    {% endif %}
    <div class="panel panel-default">
        <div class="panel-body">
           <h3>{% trans 'Session of' %} {{current_session.month_session_name|lower}} {{current_session.academic_year}}</h3>
            <div class="alert alert-info">
                <i class="fa fa-info-circle" aria-hidden="true"></i>
                {% trans "'Lists of students enrolled to my exams' are immediately usable for encoding scores." %}
            </div>
            <br>
            <form method="post" name="form_students_list">
                <div class="row">
                    {% csrf_token %}
                    <div class="col-md-12">
                        {% if my_learning_units %}
                            <table class="table">
                                <thead>
                                <th>{% trans 'List code' %}</th>
                                <th>{% trans 'Title' context 'score sheet export'%}</th>
                                <th>
                                    {% trans 'Scores responsible' %}
                                    <span class="glyphicon glyphicon-question-sign "
                                          title="{% trans 'All tutors can encode scores but only the scores responsible can submit. If the scores responsible is not correct, please contact your faculty.' %}"
                                          style="font-size: 14pt; display: inline">
                                    </span>
                                    </abbr>
                                </th>
                                <th>{% trans 'Download the list (Excel or PDF)' %}</th>
                                </thead>
                                <tbody>
                                {% for learning_unit_yr in my_learning_units %}
                                    <tr>
                                        <td>{{ learning_unit_yr.acronym }}</td>
                                        <td>{{ learning_unit_yr.complete_title|default_if_none:"" }}</td>
                                        <td>{{ learning_unit_yr.score_responsible }}</td>
                                        <td align="center">
                                            <button style="background-color: transparent; border: transparent; color: #2e6da4"
                                                    class="{% if learning_unit_yr.learning_unit_has_classes %}btn-disable{% endif %}"
                                                    id="bt_produce_xls_score_encoding_{{ learning_unit_yr.id }}"
                                                    type="button"
                                                    {% if learning_unit_yr.learning_unit_has_classes %} disabled{% endif %}>
                                                <a href="{% url 'scores_sheet_xls' learning_unit_yr.acronym %}"
                                                   {% if learning_unit_yr.learning_unit_has_classes %} disabled{% endif %}
                                                    class="{% if learning_unit_yr.learning_unit_has_classes %} disabled{% endif %}"
                                                    title="{% if learning_unit_yr.learning_unit_has_classes %}{% trans 'This learning unit has classes. Students are enrolled at the class level (see below). If you do not see any classes, please contact your faculty so that you can be assigned to the classes you teach.' %}{% else %}{% trans 'Excel File' %}{% endif %}">
                                                    <i class="fa fa-file-excel-o {% if learning_unit_yr.learning_unit_has_classes %}i-disabled{% endif %}" aria-hidden="true" style="font-size: 200%"></i>
                                                </a>
                                            </button>
                                            <button style="background-color: transparent; border: transparent; color: #2e6da4"
                                                    class="{% if learning_unit_yr.learning_unit_has_classes %}btn-disable{% endif %}"
                                                    id="bt_produce_pdf_score_encoding_{{ learning_unit_yr.id }}"
                                                    type="button"
                                                    {% if learning_unit_yr.learning_unit_has_classes %} disabled{% endif %}>
                                                <a href="{% url 'scores_sheet_pdf' learning_unit_yr.acronym %}"
                                                   {% if learning_unit_yr.learning_unit_has_classes %} disabled{% endif %}
                                                   class="{% if learning_unit_yr.learning_unit_has_classes %} disabled{% endif %}"
                                                   title="{% if learning_unit_yr.learning_unit_has_classes %}{% trans 'This learning unit has classes. Students are enrolled at the class level (see below). If you do not see any classes, please contact your faculty so that you can be assigned to the classes you teach.' %}{% else %}{% trans 'PDF File' %}{% endif %}">
                                                    <i class="fa fa-file-pdf-o {% if learning_unit_yr.learning_unit_has_classes %}i-disabled{% endif %}" aria-hidden="true" style="font-size: 200%"></i>
                                                </a>
                                            </button>
                                        </td>
                                    </tr>
                                    {% if learning_unit_yr.effective_class_repartition %}
                                        {% for classe in learning_unit_yr.effective_class_repartition %}
                                            <tr>
                                                <td>{{ classe.code }}</td>
                                                <td>{{ classe.title_fr|default_if_none:"" }}</td>
                                                <td></td>
                                                <td align="center">
                                                {% with classe.code|slice:"-1:" as classe_letter_code %}
                                                    {% with learning_unit_yr.acronym|add:classe_letter_code as learning_unit_code %}
                                                    <button style="background-color: transparent; border: transparent; color: #2e6da4"
                                                            type="button">
                                                        <a href="{% url 'scores_sheet_xls' learning_unit_code %}"
                                                            title="{% trans 'Excel File' %}">
                                                            <i class="fa fa-file-excel-o" aria-hidden="true" style="font-size: 200%"></i>
                                                        </a>
                                                    </button>
                                                    <button style="background-color: transparent; border: transparent; color: #2e6da4" type="button">
                                                        <a href="{% url 'scores_sheet_pdf' learning_unit_code %}"
                                                           title="{% trans 'PDF File' %}">
                                                            <i class="fa fa-file-pdf-o" aria-hidden="true" style="font-size: 200%"></i>
                                                        </a>
                                                    </button>
                                                    {% endwith %}
                                                {% endwith %}
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    {% endif %}
                                {% endfor %}
                                </tbody>
                            </table>
                        {% else %}
                            <div class="alert alert-info">{% trans "You aren't teaching for any learning unit" %}</div>
                        {% endif %}
                    </div>
                </div>
                <br>
            </form>
            <div class="alert alert-info">
                {% trans 'The list of students enrolled to courses are available in ' %}
                <a href="{% url 'attribution_home' %}">{% trans 'My teaching charge' %}.</a>
            </div>
        </div>
    </div>
{% endblock %}

