{% extends "bootstrap5/layout.html" %}
{% load static %}
{% load i18n %}

{% comment "License" %}
    * OSIS stands for Open Student Information System. It's an application
    * designed to manage the core business of higher education institutions,
    * such as universities, faculties, institutes and professional schools.
    * The core business involves the administration of students, teachers,
    * courses, programs and so on.
    *
    * Copyright (C) 2015-2018 Universit√© catholique de Louvain (http://www.uclouvain.be)
    *
    * This program is free software: you can redistribute it and/or modify
    * it under the terms of the GNU General Public License as published by
    * the Free Software Foundation, either version 3 of the License, or
    * (at your option) any later version.
    *
    * This program is distributed in the hope that it will be useful,
    * but WITHOUT ANY WARRANTY; without even the implied warranty of
    * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    * GNU General Public License for more details.
    *
    * A copy of this license - GNU General Public License - is available
    * at the root of the source code of this program.  If not,
    * see http://www.gnu.org/licenses/.
{% endcomment %}

{% block breadcrumb_area %}
    <ol class="breadcrumb">
        <li class="breadcrumb-item d-inline-block"><a href="{% url 'dashboard_home' %}" id="lnk_home_osis"><i class="fas fa-home"
        aria-hidden="true"></i></a></li>
        {% block breadcrumb %}
            <li class="breadcrumb-item d-inline-block">{% trans 'My applications' %}</li>
            <a href="{{ help_button_url }}"
                target="help" id="lnk_user_manual_section"><i
                class="fa-solid fa-circle-question float-end text-success fs-4"
                aria-hidden="true"></i>
            </a>
        {% endblock %}
    </ol>
{% endblock %}

{% block content %}
    <small style="color:black;font-family:Verdana;"
           class="float-end">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% trans 'Application period from' %}
        {{ application_course_calendar.start_date | default_if_none:''|date:"d/m/Y"}} {% trans 'to' %}
        {{ application_course_calendar.end_date | default_if_none:''|date:"d/m/Y" }}</small>
    <h1>{% trans 'My applications' %}</h1>
    <h2>{{ a_person.first_name }} {{ a_person.last_name }} - {{ a_person.global_id }}</h2>

    {% include "template_messages.html" %}

    <div class="card mb-3" id="pnl_applications">
        <div class="card-header">
            <div class="row">
                <div class="col-lg-11">
                    {% trans 'My applications' %} {{ application_academic_year }}
                </div>
                <div class="col-lg-1">
                    {% if applications %}
                        <form action="{% url 'email_tutor_application_confirmation' %}"
                              method="POST"
                              id="form_email_tutor_application_confirmation">
                            {% csrf_token %}
                            <button class="btn btn-primary float-end"
                                    id="btn_applications_email_confirmation"
                                    type="submit"
                                    title="{% trans 'To receive a confirmation email with the applications' %}">
                                <i class="fa-solid fa-envelope"></i>
                            </button>
                        </form>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="card-body">
            {% if applications %}
                {% include "applications_list.html" with applications=applications %}
            {% else %}
                <div class="alert alert-info mt-2">{% trans 'No application' %}</div>
            {% endif %}
            <br>
            <div class="clearfix">
                <a id="lnk_submit_attribution_new" class="btn btn-primary float-start"
                   href="{% url 'search_vacant_courses' %}">
                    <i class="fa-solid fa-plus" aria-hidden="true"></i>
                    {% trans 'Add a new application' %}
                </a>
            </div>
        </div>
    </div>
    {% if attributions_about_to_expire %}
        <div class="card mb-3" id="pnl_charges_about_to_expire">
            <div class="card-header">{% trans 'My charges now vacant' %}
                ({% trans 'without application' %}) {{ previous_academic_year }}</div>
            <div class="card-body">
                {% include "attribution_renewal_list.html" with attributions=attributions_about_to_expire %}
                <br>
            </div>
        </div>
    {% endif %}

    <div class="card mb-3" id="pnl_charges">
        <div class="card-header">{% trans 'My charges' %} {{ application_academic_year }}</div>
        <div class="card-body">
            {% if attributions %}
                {% include "attribution_list.html" with attributions=attributions %}
                <br>
            {% endif %}
        </div>
    </div>

{% endblock %}

{% block script %}
    <script src="{% static 'js/attribution.js' %}"></script>
{% endblock %}
