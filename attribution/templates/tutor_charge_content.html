{% load staticfiles %}
{% load i18n function academic_year_display %}

{% comment "License" %}
    * OSIS stands for Open Student Information System. It's an application
    * designed to manage the core business of higher education institutions,
    * such as universities, faculties, institutes and professional schools.
    * The core business involves the administration of students, teachers,
    * courses, programs and so on.
    *
    * Copyright (C) 2015-2021 Universit√© catholique de Louvain (http://www.uclouvain.be)
    *
    * This program is free software: you can redistribute it and/or modify
    * it under the terms of the GNU General Public License as published by
    * the Free Software Foundation, either version 3 of the License, or
    * (at your option) any later version.
    *
    * This program is distributed in the hope that it will be useful,
    * but WITHOUT ANY WARRANTY; without even the implied warranty of
    * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    * GNU General Public License for more details.
    *
    * A copy of this license - GNU General Public License - is available
    * at the root of the source code of this program.  If not,
    * see http://www.gnu.org/licenses/.
{% endcomment %}
<h1>{% trans 'Teaching charge' %}</h1>
<h2>
    {{ person.user.first_name }} {{ person.user.last_name }}
</h2>

<div class="alert alert-warning">
    <i class="fa fa-exclamation-triangle"></i>  {% trans 'Lists of students are available by clicking on the symbol' %} <span class="fa fa-group" aria-hidden="true" style="color: #367FB9"></span>{% trans ' in the column "Students"' %}</span>
</div>

<ul class="nav nav-tabs">
    {% for tab in display_years_tab %}
        <li {% if tab.is_active %}class="active"{% endif %}>
            <a href="{{ tab.url }}">
                {{ tab.year|display_as_academic_year }}
            </a>
        </li>
    {% endfor %}
</ul>

{% if attributions %}
    <table class="table table-striped table-hover">
        <tr>
            <th>{% trans 'Code' %}</th>
            <th>{% trans 'Title' %}</th>
            <th>{% trans 'Start' %}</th>
            <th>{% trans 'Vol.1' %}</th>
            <th>{% trans 'Vol.2' %}</th>
            <th>%</th>
            <th>{% trans 'ECT' %}</th>
            <th>{% trans 'Students' %}</th>
            <th>{% trans 'Schedule' %}</th>
            <th>{% trans 'Email' %}</th>
            <th>{% trans 'Function' %}</th>
        </tr>
        {% for attribution in attributions %}
            <tr>
                <td>
                    {% if attribution.links.catalog %}
                        <a href="{{ attribution.links.catalog }}" target="_blank">{{ attribution.code }}</a>
                    {% else %}
                        {{ attribution.code }}
                    {% endif %}
                </td>
                <td>{{ attribution.title_fr }}</td>
                <td>{{ attribution.start_year | default_if_none:''}}</td>
                <td>{{ attribution.lecturing_charge | default_if_none:''}}</td>
                <td>{{ attribution.practical_charge | default_if_none:''}}</td>
                <td>{{ attribution.percentage_allocation_charge | default_if_none:''}}</td>
                <td>{{ attribution.credits | default_if_none:''}}</td>
                <td>
                    <a href="{{ attribution.attribution_students_url }}">
                        <span class="fa fa-group" aria-hidden="true"></span>
                    </a>
                    {% if attribution.has_peps %}
                        <span class="label label-warning"
                              title="{% trans 'Some of the students enrolled to this course have a PEPS status (Program for Students with a Specific Profile)'%}">
                            PEPS
                        </span>
                    {% endif%}
                </td>
                <td>
                    {% if attribution.links.schedule %}
                        <a target="_blank" href="{{ attribution.links.schedule }}">
                            <span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span>
                        </a>
                    {% else %}
                        <div class="tooltip-wrapper" data-toggle="tooltip" data-placement="top"
                             title="{% trans 'Schedule unavailable' %}">
                             <span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span>
                        </div>
                    {% endif %}
                </td>
                <td>
                    <a href="{{ attribution.students_list_email }}">
                        <span class="glyphicon glyphicon-envelope" aria-hidden="true"></span>
                    </a>
                </td>
                <td>{{ attribution.function|function_text }}</td>
            </tr>
        {% endfor %}
        <tr>
            <td></td>
            <td><label>{% trans 'Total' %}</label></td>
            <td></td>
            <td>{{ total_lecturing_charge }}</td>
            <td>{{ total_practical_charge }}</td>
            <td colspan="6"></td>
        </tr>
    </table>
{% else %}
    <br>
    <div class="alert alert-info" role="alert">{% trans 'No teaching charge in ' %} {{ current_year_displayed|display_as_academic_year }}</div>
{% endif %}
